<!DOCTYPE html>
<html>
<head>
  <title>SQL for Python Programmers</title>

  <link rel="stylesheet" href="/sql_python_tutorial/assets/css/main.css">
  <link rel="shortcut icon" type="image/png" href="/sql_python_tutorial/assets/favicon.ico"/>
   
<style media="screen" type="text/css">


div.input_prompt {
  color: #303F9F;
}

div.output_prompt {
  color: #D84315;
}
</style>

    <!-- Loading mathjax macro -->
    <!-- Load mathjax -->
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
        <!-- MathJax configuration -->
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: true,
                processEnvironments: true
            },
            // Center justify equations in code and markdown cells. Elsewhere
            // we use CSS to left justify single line equations in code cells.
            displayAlign: 'center',
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}},
                linebreaks: { automatic: true }
            }
        });
        </script>
        <!-- End of mathjax configuration --></head>

</head>
<body>

    <header class="site-header">

  <div class="wrap">


    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
          <a class="page-link" href="/sql_python_tutorial/">SQL for Python Programmers</a>
      </div>
    </nav>

  </div>
</header>

 <div class="page-content">
    <div class="wrap">
      <div class="home">
        
    
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Create-a-Table">Create a Table<a class="anchor-link" href="#Create-a-Table">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sqlalchemy</span> <span class="k">as</span> <span class="nn">sa</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;sqlite:///flight.db&#39;</span><span class="p">)</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">CREATE TABLE readings (</span>
<span class="s2">    flight    VARCHAR(10) NOT NULL,</span>
<span class="s2">    ts        TIMESTAMP NOT NULL,</span>
<span class="s2">    temp      NUMERIC(3,1) NOT NULL,</span>
<span class="s2">    pressure  NUMERIC(4,0) NOT NULL,</span>
<span class="s2">    humidity  NUMERIC(3,0) NOT NULL,</span>
<span class="s2">    accel_x   REAL DEFAULT 0 NOT NULL,</span>
<span class="s2">    accel_y   REAL DEFAULT 0 NOT NULL,</span>
<span class="s2">    accel_z   REAL DEFAULT 0 NOT NULL,</span>

<span class="s2">    CONSTRAINT readings_pk PRIMARY KEY (flight, ts),</span>
<span class="s2">    CONSTRAINT temp_ck CHECK (temp BETWEEN -70 AND 70),</span>
<span class="s2">    CONSTRAINT pres_ck CHECK (pressure BETWEEN 0 AND 2000),</span>
<span class="s2">    CONSTRAINT hum_ck CHECK (humidity BETWEEN 0 AND 100)</span>
<span class="s2">)</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">OperationalError</span>                          Traceback (most recent call last)
<span class="ansi-green-fg">~/miniconda3/envs/sql_python_tutorial/lib/python3.6/site-packages/sqlalchemy/engine/base.py</span> in <span class="ansi-cyan-fg">_execute_context</span><span class="ansi-blue-fg">(self, dialect, constructor, statement, parameters, *args)</span>
<span class="ansi-green-intense-fg ansi-bold">   1192</span>                         parameters<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 1193</span><span class="ansi-red-fg">                         context)
</span><span class="ansi-green-intense-fg ansi-bold">   1194</span>         <span class="ansi-green-fg">except</span> BaseException <span class="ansi-green-fg">as</span> e<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/miniconda3/envs/sql_python_tutorial/lib/python3.6/site-packages/sqlalchemy/engine/default.py</span> in <span class="ansi-cyan-fg">do_execute</span><span class="ansi-blue-fg">(self, cursor, statement, parameters, context)</span>
<span class="ansi-green-intense-fg ansi-bold">    506</span>     <span class="ansi-green-fg">def</span> do_execute<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> cursor<span class="ansi-blue-fg">,</span> statement<span class="ansi-blue-fg">,</span> parameters<span class="ansi-blue-fg">,</span> context<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 507</span><span class="ansi-red-fg">         </span>cursor<span class="ansi-blue-fg">.</span>execute<span class="ansi-blue-fg">(</span>statement<span class="ansi-blue-fg">,</span> parameters<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    508</span> 

<span class="ansi-red-fg">OperationalError</span>: table readings already exists

The above exception was the direct cause of the following exception:

<span class="ansi-red-fg">OperationalError</span>                          Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-3-6c7d01cac973&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     16</span> )
<span class="ansi-green-intense-fg ansi-bold">     17</span> &#34;&#34;&#34;
<span class="ansi-green-fg">---&gt; 18</span><span class="ansi-red-fg"> </span>connection<span class="ansi-blue-fg">.</span>execute<span class="ansi-blue-fg">(</span>sql<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/miniconda3/envs/sql_python_tutorial/lib/python3.6/site-packages/sqlalchemy/engine/base.py</span> in <span class="ansi-cyan-fg">execute</span><span class="ansi-blue-fg">(self, object, *multiparams, **params)</span>
<span class="ansi-green-intense-fg ansi-bold">    940</span>         &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">    941</span>         <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>object<span class="ansi-blue-fg">,</span> util<span class="ansi-blue-fg">.</span>string_types<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 942</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_execute_text<span class="ansi-blue-fg">(</span>object<span class="ansi-blue-fg">,</span> multiparams<span class="ansi-blue-fg">,</span> params<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    943</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    944</span>             meth <span class="ansi-blue-fg">=</span> object<span class="ansi-blue-fg">.</span>_execute_on_connection

<span class="ansi-green-fg">~/miniconda3/envs/sql_python_tutorial/lib/python3.6/site-packages/sqlalchemy/engine/base.py</span> in <span class="ansi-cyan-fg">_execute_text</span><span class="ansi-blue-fg">(self, statement, multiparams, params)</span>
<span class="ansi-green-intense-fg ansi-bold">   1102</span>             statement<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   1103</span>             parameters<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 1104</span><span class="ansi-red-fg">             </span>statement<span class="ansi-blue-fg">,</span> parameters
<span class="ansi-green-intense-fg ansi-bold">   1105</span>         )
<span class="ansi-green-intense-fg ansi-bold">   1106</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_has_events <span class="ansi-green-fg">or</span> self<span class="ansi-blue-fg">.</span>engine<span class="ansi-blue-fg">.</span>_has_events<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/miniconda3/envs/sql_python_tutorial/lib/python3.6/site-packages/sqlalchemy/engine/base.py</span> in <span class="ansi-cyan-fg">_execute_context</span><span class="ansi-blue-fg">(self, dialect, constructor, statement, parameters, *args)</span>
<span class="ansi-green-intense-fg ansi-bold">   1198</span>                 parameters<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   1199</span>                 cursor<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 1200</span><span class="ansi-red-fg">                 context)
</span><span class="ansi-green-intense-fg ansi-bold">   1201</span> 
<span class="ansi-green-intense-fg ansi-bold">   1202</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_has_events <span class="ansi-green-fg">or</span> self<span class="ansi-blue-fg">.</span>engine<span class="ansi-blue-fg">.</span>_has_events<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/miniconda3/envs/sql_python_tutorial/lib/python3.6/site-packages/sqlalchemy/engine/base.py</span> in <span class="ansi-cyan-fg">_handle_dbapi_exception</span><span class="ansi-blue-fg">(self, e, statement, parameters, cursor, context)</span>
<span class="ansi-green-intense-fg ansi-bold">   1411</span>                 util.raise_from_cause(
<span class="ansi-green-intense-fg ansi-bold">   1412</span>                     sqlalchemy_exception<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 1413</span><span class="ansi-red-fg">                     </span>exc_info
<span class="ansi-green-intense-fg ansi-bold">   1414</span>                 )
<span class="ansi-green-intense-fg ansi-bold">   1415</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/miniconda3/envs/sql_python_tutorial/lib/python3.6/site-packages/sqlalchemy/util/compat.py</span> in <span class="ansi-cyan-fg">raise_from_cause</span><span class="ansi-blue-fg">(exception, exc_info)</span>
<span class="ansi-green-intense-fg ansi-bold">    201</span>     exc_type<span class="ansi-blue-fg">,</span> exc_value<span class="ansi-blue-fg">,</span> exc_tb <span class="ansi-blue-fg">=</span> exc_info
<span class="ansi-green-intense-fg ansi-bold">    202</span>     cause <span class="ansi-blue-fg">=</span> exc_value <span class="ansi-green-fg">if</span> exc_value <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> exception <span class="ansi-green-fg">else</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-fg">--&gt; 203</span><span class="ansi-red-fg">     </span>reraise<span class="ansi-blue-fg">(</span>type<span class="ansi-blue-fg">(</span>exception<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> exception<span class="ansi-blue-fg">,</span> tb<span class="ansi-blue-fg">=</span>exc_tb<span class="ansi-blue-fg">,</span> cause<span class="ansi-blue-fg">=</span>cause<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    204</span> 
<span class="ansi-green-intense-fg ansi-bold">    205</span> <span class="ansi-green-fg">if</span> py3k<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/miniconda3/envs/sql_python_tutorial/lib/python3.6/site-packages/sqlalchemy/util/compat.py</span> in <span class="ansi-cyan-fg">reraise</span><span class="ansi-blue-fg">(tp, value, tb, cause)</span>
<span class="ansi-green-intense-fg ansi-bold">    184</span>             value<span class="ansi-blue-fg">.</span>__cause__ <span class="ansi-blue-fg">=</span> cause
<span class="ansi-green-intense-fg ansi-bold">    185</span>         <span class="ansi-green-fg">if</span> value<span class="ansi-blue-fg">.</span>__traceback__ <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> tb<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 186</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> value<span class="ansi-blue-fg">.</span>with_traceback<span class="ansi-blue-fg">(</span>tb<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    187</span>         <span class="ansi-green-fg">raise</span> value
<span class="ansi-green-intense-fg ansi-bold">    188</span> 

<span class="ansi-green-fg">~/miniconda3/envs/sql_python_tutorial/lib/python3.6/site-packages/sqlalchemy/engine/base.py</span> in <span class="ansi-cyan-fg">_execute_context</span><span class="ansi-blue-fg">(self, dialect, constructor, statement, parameters, *args)</span>
<span class="ansi-green-intense-fg ansi-bold">   1191</span>                         statement<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   1192</span>                         parameters<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 1193</span><span class="ansi-red-fg">                         context)
</span><span class="ansi-green-intense-fg ansi-bold">   1194</span>         <span class="ansi-green-fg">except</span> BaseException <span class="ansi-green-fg">as</span> e<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1195</span>             self._handle_dbapi_exception(

<span class="ansi-green-fg">~/miniconda3/envs/sql_python_tutorial/lib/python3.6/site-packages/sqlalchemy/engine/default.py</span> in <span class="ansi-cyan-fg">do_execute</span><span class="ansi-blue-fg">(self, cursor, statement, parameters, context)</span>
<span class="ansi-green-intense-fg ansi-bold">    505</span> 
<span class="ansi-green-intense-fg ansi-bold">    506</span>     <span class="ansi-green-fg">def</span> do_execute<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> cursor<span class="ansi-blue-fg">,</span> statement<span class="ansi-blue-fg">,</span> parameters<span class="ansi-blue-fg">,</span> context<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 507</span><span class="ansi-red-fg">         </span>cursor<span class="ansi-blue-fg">.</span>execute<span class="ansi-blue-fg">(</span>statement<span class="ansi-blue-fg">,</span> parameters<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    508</span> 
<span class="ansi-green-intense-fg ansi-bold">    509</span>     <span class="ansi-green-fg">def</span> do_execute_no_params<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> cursor<span class="ansi-blue-fg">,</span> statement<span class="ansi-blue-fg">,</span> context<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">OperationalError</span>: (sqlite3.OperationalError) table readings already exists [SQL: &#39;\nCREATE TABLE readings (\n    flight    VARCHAR(10) NOT NULL,\n    ts        TIMESTAMP NOT NULL,\n    temp      NUMERIC(3,1) NOT NULL,\n    pressure  NUMERIC(4,0) NOT NULL,\n    humidity  NUMERIC(3,0) NOT NULL,\n    accel_x   REAL DEFAULT 0 NOT NULL,\n    accel_y   REAL DEFAULT 0 NOT NULL,\n    accel_z   REAL DEFAULT 0 NOT NULL,\n\n    CONSTRAINT readings_pk PRIMARY KEY (flight, ts),\n    CONSTRAINT temp_ck CHECK (temp BETWEEN -70 AND 70),\n    CONSTRAINT pres_ck CHECK (pressure BETWEEN 0 AND 2000),\n    CONSTRAINT hum_ck CHECK (humidity BETWEEN 0 AND 100)\n)\n&#39;] (Background on this error at: http://sqlalche.me/e/e3q8)</pre>
</div>
</div>

</div>
</div>

</div>
 



    
        <a href="../04/">Previous</a>
    
    
        <p align="right"><a href="../06/">Next</a></p>
    

    <div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */

    var disqus_config = function () {
        this.page.url = 'http://owencampbell.me.uk/';
        this.page.identifier = 'sql_python_tutorial';
    };

    (function() {
        var d = document, s = d.createElement('script');

        s.src = 'http://owencampbell.me.uk/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


      </div>
  </div>
</div>


</body>
</html>